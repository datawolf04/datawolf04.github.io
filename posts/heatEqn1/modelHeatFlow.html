<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Steven Wolf">
<meta name="dcterms.date" content="2024-11-03">
<meta name="description" content="Torture is bad. Also, half of my house gets too warm/cold, and that’s not my favorite.">

<title>Modeling Heat Flow – Steven Wolf - Data World</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-a1673d5ee3f94a18a47cce2766f25c64.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Steven Wolf - Data World</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://datawolf04.github.io/crossCountryMeetSummaries/"> 
<span class="menu-text">Cross Country</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/steven-wolf-253b6625a"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/datawolf04/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Modeling Heat Flow</h1>
                  <div>
        <div class="description">
          Torture is bad. Also, half of my house gets too warm/cold, and that’s not my favorite.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Heat Equation</div>
                <div class="quarto-category">Python</div>
                <div class="quarto-category">Modeling</div>
                <div class="quarto-category">3D system</div>
                <div class="quarto-category">Finite Difference Method</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Steven Wolf </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 3, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#personal-motivation-for-this-post" id="toc-personal-motivation-for-this-post" class="nav-link active" data-scroll-target="#personal-motivation-for-this-post">Personal Motivation for this post</a></li>
  <li><a href="#heat-equation" id="toc-heat-equation" class="nav-link" data-scroll-target="#heat-equation">Heat Equation</a></li>
  <li><a href="#simple-system" id="toc-simple-system" class="nav-link" data-scroll-target="#simple-system">Simple system</a>
  <ul class="collapse">
  <li><a href="#box-dimensions" id="toc-box-dimensions" class="nav-link" data-scroll-target="#box-dimensions">Box dimensions</a></li>
  <li><a href="#thermal-properties-of-the-box" id="toc-thermal-properties-of-the-box" class="nav-link" data-scroll-target="#thermal-properties-of-the-box">Thermal properties of the box</a></li>
  <li><a href="#modeling-exterior-temperature" id="toc-modeling-exterior-temperature" class="nav-link" data-scroll-target="#modeling-exterior-temperature">Modeling exterior temperature</a></li>
  </ul></li>
  <li><a href="#going-from-differential-equations-to-matrix-equations" id="toc-going-from-differential-equations-to-matrix-equations" class="nav-link" data-scroll-target="#going-from-differential-equations-to-matrix-equations">Going from differential equations to matrix equations</a>
  <ul class="collapse">
  <li><a href="#applying-the-finite-difference-method-to-the-boundary-condition" id="toc-applying-the-finite-difference-method-to-the-boundary-condition" class="nav-link" data-scroll-target="#applying-the-finite-difference-method-to-the-boundary-condition">Applying the Finite difference method to the boundary condition</a></li>
  <li><a href="#applying-the-finite-difference-method-to-the-heat-equation-dotu-alphanabla2u" id="toc-applying-the-finite-difference-method-to-the-heat-equation-dotu-alphanabla2u" class="nav-link" data-scroll-target="#applying-the-finite-difference-method-to-the-heat-equation-dotu-alphanabla2u">Applying the finite difference method to the heat equation: <span class="math inline">\(\dot{u} = \alpha\nabla^2u\)</span></a></li>
  <li><a href="#visualizing-the-temperature" id="toc-visualizing-the-temperature" class="nav-link" data-scroll-target="#visualizing-the-temperature">Visualizing the temperature:</a></li>
  </ul></li>
  <li><a href="#sec-results" id="toc-sec-results" class="nav-link" data-scroll-target="#sec-results">Results</a>
  <ul class="collapse">
  <li><a href="#different-initial-condition-comparison" id="toc-different-initial-condition-comparison" class="nav-link" data-scroll-target="#different-initial-condition-comparison">Different initial condition comparison</a></li>
  <li><a href="#compare-interior-temperature-to-exterior-temp" id="toc-compare-interior-temperature-to-exterior-temp" class="nav-link" data-scroll-target="#compare-interior-temperature-to-exterior-temp">Compare interior temperature to exterior temp</a></li>
  <li><a href="#heatmaps" id="toc-heatmaps" class="nav-link" data-scroll-target="#heatmaps">Heatmaps</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a>
  <ul class="collapse">
  <li><a href="#next-step" id="toc-next-step" class="nav-link" data-scroll-target="#next-step">Next step</a></li>
  <li><a href="#my-future-plans" id="toc-my-future-plans" class="nav-link" data-scroll-target="#my-future-plans">My future plans:</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="personal-motivation-for-this-post" class="level2">
<h2 class="anchored" data-anchor-id="personal-motivation-for-this-post">Personal Motivation for this post</h2>
<p>I have a house, and I need to improve the heating/cooling in it. Essentially, the problem is that my house is a long and narrow, and the air return is not able to sufficiently draw the cold/hot air from rooms on the far side of the house. Essentially, the air return/exchange system is not sufficient. As a result, half of my house is really hot in the summer/extra chilly in the winter.</p>
<p>There is some ducting in place intended to aid circulation, but it is ineffective as it doesn’t draw any air from the hot/cold room, relying on diffusion only to drive circulation. Furthermore, it is located in a bedroom rather than the living room which is significantly larger, more distant from the return, and–as a result–has the largest temperature problem. I am planning on installing a duct fan, which will help solve this problem. But that leaves these questions:</p>
<ol type="1">
<li>How strong should my duct fan be?</li>
<li>Will the existing return be enough to alleviate the problem by simply adding in a duct fan?</li>
<li>If the answer to the previous question is no, where should I put another vent to make the biggest impact?</li>
</ol>
<p>I figure I can use my physics brain, and a little code to analyze this problem. So I’m going to spend some time figuring out how to implement the heat equation with appropriate boundary conditions applying them to scenarios that are progressively more complex, until I feel that I can apply them to my own house.</p>
</section>
<section id="heat-equation" class="level2">
<h2 class="anchored" data-anchor-id="heat-equation">Heat Equation</h2>
<p>All of this starts by understanding heat flow. The heat equation is:</p>
<p><span class="math display">\[
\frac{\partial u}{\partial t} = \alpha \nabla^2u
\]</span></p>
<p>where <span class="math inline">\(u = u(x,y,z,t)\)</span> is a function describing the temperature at every point in space and time in the region of interest and <span class="math inline">\(\alpha\)</span> is the Thermal Diffusivity of the material (which can depend on position as well). There are many boundary conditions that can be applied, but I will apply <em>Robin Conditions</em> which generally apply to convection/conduction.</p>
<p><span class="math display">\[
k \left. \frac{\partial u}{\partial n}\right|_{S} = h \left(u(S,t) - v(S, t)\right)
\]</span></p>
<p>Here <span class="math inline">\(n\)</span> is the direction of the outward normal of the boundary surface, <span class="math inline">\(S\)</span> indicates a spatial point on the boundary surface, <span class="math inline">\(k\)</span> is the thermal conductivity, <span class="math inline">\(h\)</span> is the heat transfer coefficient, and <span class="math inline">\(v\)</span> is the temperature on the other side of the boundary. This is the “Newton’s law of cooling” that you may have heard about in an introductory calculus class, although, it is usually presented as:</p>
<p><span class="math display">\[
\frac{dT}{dt} = -a(T-T_0)
\]</span> where <span class="math inline">\(a\)</span> is some sort of constant, and <span class="math inline">\(T_0\)</span> is the temperature of the surroundings. What this means is that the steady-state behavior of this system is that it tends towards the temperature of the surroundings. This has limitations which I will discuss later.</p>
</section>
<section id="simple-system" class="level2">
<h2 class="anchored" data-anchor-id="simple-system">Simple system</h2>
<p>As a “simple” 3D system, I’ll model a <a href="https://en.wikipedia.org/wiki/Box_(torture)">“hot box” or “sweatbox” used by some for torture</a>. This is not, nor should it be construed as an endorsement of torture. It’s just a simple box, and it gives me some intuitive knobs to use as I work this problem. Also, given the boundary condition that I previously mentioned, this means that the box can never be warmer than the surroundings. This isn’t fully realistic yet, as anyone who has seen a PSA about leaving kids/pets in a hot car even on a “cool” day. But there’s enough here to get me to start writing code.</p>
<section id="box-dimensions" class="level3">
<h3 class="anchored" data-anchor-id="box-dimensions">Box dimensions</h3>
<p>I will model this as a box with length <span class="math inline">\(L\)</span>, width <span class="math inline">\(W\)</span>, and height <span class="math inline">\(H\)</span>. I’ll orient my coordinate system so that the origin is in a lower corner and points <span class="math inline">\((x,y,z)\)</span> in the region of interest are bounded by the following: <span class="math inline">\(0\leq x\leq L\)</span>, <span class="math inline">\(0\leq y \leq W\)</span>, and <span class="math inline">\(0\leq z \leq H\)</span>.</p>
<div id="d58290dd" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Length and time parameters (meters)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>oneDay <span class="op">=</span> <span class="dv">24</span><span class="op">*</span><span class="dv">60</span><span class="op">*</span><span class="dv">60</span> <span class="co"># seconds</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="dv">10</span><span class="op">*</span>oneDay <span class="co"># Let this run for several days</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="thermal-properties-of-the-box" class="level3">
<h3 class="anchored" data-anchor-id="thermal-properties-of-the-box">Thermal properties of the box</h3>
<p>I will assume that the box is uniform. That means no windows or ventilation. So <span class="math inline">\(h\)</span> and <span class="math inline">\(k\)</span> are constant and uniform on the boundary. According to Wikipedia, the thermal diffusivity of air is <span class="math inline">\(1.9\times 10^{-7}\)</span> m<span class="math inline">\(^2\)</span>/s. According to <a href="https://doi.org/10.1016/0360-1323(96)00014-5">this article by Jayamaha <em>et.al.</em></a>, the heat transfer coefficient for walls varies from 6 to 10 <span class="math inline">\(\frac{\text{W}}{\text{m}^2 \text{K}}\)</span>. Looking at the <a href="https://www.greenspec.co.uk/building-design/insulation-materials-thermal-properties/">greenspec.co.uk website</a> it would seem that the thermal conductivity of most building materials is on the order of 0.02-0.04 <span class="math inline">\(\frac{\text{W}}{\text{m K}}\)</span>.</p>
<div id="01b94115" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Heat parameters</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">1.9e-7</span> <span class="co"># meters^2/s for air</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> <span class="dv">10</span> <span class="co"># From Jayamaha</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="fl">0.04</span> <span class="co"># From Greenspec</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modeling-exterior-temperature" class="level3">
<h3 class="anchored" data-anchor-id="modeling-exterior-temperature">Modeling exterior temperature</h3>
<p>I’m going to assume the air temperature is time-dependent, and takes the form:</p>
<p><span class="math display">\[
v^{\text{air}}(t) = T_0 - \Delta T \cos\left(\Omega t\right)
\]</span></p>
<p>where <span class="math inline">\(T_0\)</span> is the average temperature of the day, and <span class="math inline">\(\Delta T\)</span> represents the range of temperature. On the ground, I’ll assume the temperature is constant at <span class="math inline">\(T_G\)</span>. So <span class="math inline">\(t=0\)</span> is sunrise. Making these parameters functions is overkill for now, but will be helpful as I get more complicated.</p>
<div id="604bede8" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperature parameters</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>T0 <span class="op">=</span> <span class="dv">33</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>DT <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>TG <span class="op">=</span> <span class="dv">35</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> vair(T0,DT,t):</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  Omega <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>np.pi<span class="op">/</span>oneDay</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  vair <span class="op">=</span> T0 <span class="op">-</span> DT <span class="op">*</span> np.cos(Omega <span class="op">*</span> t)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> vair</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> vground(TG, t):</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> TG</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="going-from-differential-equations-to-matrix-equations" class="level2">
<h2 class="anchored" data-anchor-id="going-from-differential-equations-to-matrix-equations">Going from differential equations to matrix equations</h2>
<p>This is going to get a bit technical, and if you want to skip the details of the math behind the algorithm you can skip to the results in <a href="#sec-results" class="quarto-xref">Section&nbsp;5</a>.</p>
<p>Essentially, the basis for all numerical methods involving systems that evolve in space and time is to replace continuous space and time values with a discrete mesh of space and time values. For this system, we are looking for the temperature at every location in space and time. So we will do this on a reduced space/time grid. Instead of having a function of <span class="math inline">\((x,y,z,t)\)</span> we will have a 4-dimensional matrix that I will denote as follows:</p>
<p><span class="math display">\[
u(x,y,z,t) \rightarrow u(x_i,y_j,z_k,t_l) = u^l_{ijk}
\]</span></p>
<p>For this I will define:</p>
<p><span class="math display">\[
\begin{align*}
x_i &amp;= i \Delta x \\
y_j &amp;= j \Delta y \\
z_k &amp;= k \Delta z \\
t_l &amp;= l \Delta t \\
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\Delta x, \Delta y, \Delta z,\)</span> and <span class="math inline">\(\Delta t\)</span> are computational choices. Indeed, this freedom will allow me to choose <span class="math inline">\(\Delta x = \Delta y = \Delta z\)</span>. I will choose <span class="math inline">\(\Delta x = 5\)</span> cm and <span class="math inline">\(\Delta t = 15\)</span> minutes. I’ll also define the max indices for this system, and also set up values for the grid. I will also set up the <span class="math inline">\(u^l_{ijk}\)</span> grid, and fill it with a constant value. Actually, I will do this for two different initial temperatures. If my code is working correctly, the initial temperature of the box should not matter if we let the simulation run for long enough. Think about it this way: Imagine that you have two identical coolers, one filled with ice and the other empty. Now, let the coolers sit for a year in your yard. After that year, the coolers will no longer have a different temperature.</p>
<div id="2df29995" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Computational parameters (time step and mesh size)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>Deltat <span class="op">=</span> <span class="dv">60</span><span class="op">*</span><span class="dv">15</span> <span class="co"># 15 minutes in seconds</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>Deltax <span class="op">=</span> <span class="fl">0.05</span>  <span class="co"># 5 cm in meters</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>xmax <span class="op">=</span> <span class="bu">int</span>(L<span class="op">/</span>Deltax)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>ymax <span class="op">=</span> <span class="bu">int</span>(W<span class="op">/</span>Deltax)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>zmax <span class="op">=</span> <span class="bu">int</span>(H<span class="op">/</span>Deltax)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>tmax <span class="op">=</span> <span class="bu">int</span>(T<span class="op">/</span>Deltat)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>xmid <span class="op">=</span> xmax <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>ymid <span class="op">=</span> ymax <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>zmid <span class="op">=</span> zmax <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(<span class="dv">0</span>,T,tmax)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>xgrid <span class="op">=</span> np.linspace(<span class="dv">0</span>,L,xmax<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>ygrid <span class="op">=</span> np.linspace(<span class="dv">0</span>,W,ymax<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>zgrid <span class="op">=</span> np.linspace(<span class="dv">0</span>,H,zmax<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize the array(s) with a few different initial temperatures.</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.empty((tmax,xmax,ymax,zmax))</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>uAlt <span class="op">=</span> np.empty((tmax,xmax,ymax,zmax))</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>u_init <span class="op">=</span> T0<span class="op">-</span>DT</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>u.fill(u_init)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>uAlt_init <span class="op">=</span> (T0<span class="op">+</span>TG)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>uAlt.fill(uAlt_init)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="applying-the-finite-difference-method-to-the-boundary-condition" class="level3">
<h3 class="anchored" data-anchor-id="applying-the-finite-difference-method-to-the-boundary-condition">Applying the Finite difference method to the boundary condition</h3>
<p>The boundary condition for conduction/convection states that the gradient of the temperature function at the boundary is proportional to the temperature difference across that boundary. For example on the surface where <span class="math inline">\(x=0\)</span> (or <span class="math inline">\(i=0\)</span>), the outward normal direction is in the <span class="math inline">\(-x\)</span> direction: <span class="math display">\[
\left. k\frac{\partial u}{\partial x}\right|_{x=0} = h(u(x=0,y,z,t) - v(x=0,y,z,t))
\]</span> I will apply the <a href="https://en.wikipedia.org/wiki/Finite_difference_method">finite difference method</a> to find the spatial derivatives. <span class="math display">\[
\begin{align*}
\frac{\partial u}{\partial x} &amp;= \frac{u^l_{i+1 jk}-u^l_{ijk}}{\Delta x}   \\
\frac{\partial u}{\partial y} &amp;= \frac{u^l_{ij+1 k}-u^l_{ijk}}{\Delta y}   \\
\frac{\partial u}{\partial z} &amp;= \frac{u^l_{ijk+1}-u^l_{ijk}}{\Delta z}   \\
\end{align*}
\]</span></p>
<p>Therefore, for <span class="math inline">\(i=0\)</span> (the <span class="math inline">\(x=0\)</span> boundary) we get: <span class="math display">\[
u^l_{1jk} - u^l_{0jk} = \frac{h\Delta x}{k} \left(u^l_{0jk} - v^l_{jk}\right)
\]</span> Solve for <span class="math inline">\(u^l_{0jk}\)</span>: <span class="math display">\[
u^l_{0jk} = \frac{u^l_{1jk} + \beta v^l_{jk}}{1+\beta}
\]</span></p>
<p>where I have defined: <span class="math display">\[
\beta = \frac{h \Delta x}{k}
\]</span> Note that if <span class="math inline">\(\beta = 0\)</span> boundary has an infinite thermal conductivity and <span class="math inline">\(u^l_{0jk} = u^l_{1jk}\)</span> or <span class="math inline">\(\frac{\partial u}{\partial n} = 0\)</span>. This is the <em>Neumann Boundary Condition</em>. If <span class="math inline">\(\beta\rightarrow\infty\)</span>, we find <span class="math inline">\(u^l_{0jk} = v^l_{jk}\)</span> and the temperature at the boundary is equal to the exterior temperature. This is the <em>Dirichelet Boundary Condition</em>.</p>
<p>Plugging in some numbers, I’ll assume that the proportionality constant <span class="math inline">\(\beta\)</span> for heat exchange with the ground is 10 times larger than the same constant for heat exchange with the air.</p>
<p>Let’s put this into code and apply the boundary condition to the initial array:</p>
<div id="0f127a0f" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> h<span class="op">*</span>Deltax<span class="op">/</span>k</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>betaG <span class="op">=</span> <span class="dv">5</span><span class="op">*</span>beta</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> applyBC(umat, tl):</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  t <span class="op">=</span> tl<span class="op">*</span>Deltat</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  umat[tl, <span class="dv">0</span>, :, :] <span class="op">=</span> (umat[tl, <span class="dv">1</span>, :, :] <span class="op">+</span> beta <span class="op">*</span> vair(T0,DT,t))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>beta)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  umat[tl, xmax<span class="op">-</span><span class="dv">1</span>, :, :] <span class="op">=</span> (umat[tl, xmax<span class="op">-</span><span class="dv">2</span>, :, :] <span class="op">+</span> beta <span class="op">*</span> vair(T0,DT,t))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>beta)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  umat[tl, :, <span class="dv">0</span>, :] <span class="op">=</span> (umat[tl, :, <span class="dv">1</span>, :] <span class="op">+</span> beta <span class="op">*</span> vair(T0,DT,t))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>beta)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  umat[tl, :, ymax<span class="op">-</span><span class="dv">1</span>, :] <span class="op">=</span> (umat[tl, :, ymax<span class="op">-</span><span class="dv">2</span>, :] <span class="op">+</span> beta <span class="op">*</span> vair(T0,DT,t))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>beta)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  umat[tl, :, :, <span class="dv">0</span>] <span class="op">=</span> (umat[tl, :, :, <span class="dv">1</span>] <span class="op">+</span> betaG <span class="op">*</span> vground(TG,t))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>betaG)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  umat[tl, :, :, zmax<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> (umat[tl, :, :, zmax<span class="op">-</span><span class="dv">2</span>] <span class="op">+</span> beta <span class="op">*</span> vair(T0,DT,t))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>beta)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> umat</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">## Apply BCs at t=0 to finish initializing array</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> applyBC(u, <span class="dv">0</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>uAlt <span class="op">=</span> applyBC(uAlt,<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="applying-the-finite-difference-method-to-the-heat-equation-dotu-alphanabla2u" class="level3">
<h3 class="anchored" data-anchor-id="applying-the-finite-difference-method-to-the-heat-equation-dotu-alphanabla2u">Applying the finite difference method to the heat equation: <span class="math inline">\(\dot{u} = \alpha\nabla^2u\)</span></h3>
<p>I will again apply the <a href="https://en.wikipedia.org/wiki/Finite_difference_method">finite difference method</a> to find the derivatives. The first derivative in time is: <span class="math display">\[
\frac{\partial u}{\partial t} = \frac{u^{l+1}_{ijk} - u^{l}_{ijk}}{\Delta t}
\]</span></p>
<p>Another aspect of this method is that the Laplacian at any point can be calculated through the average of the difference between the nearest neighbors of that point and the point itself: <span class="math display">\[
\nabla^2 u(x,y,z,t) = \frac{u^l_{i+1 jk} + u^l_{i-1 jk} +
    u^l_{ij+1k} + u^l_{ij-1k} + u^l_{ijk+1} + u^l_{ijk-1} - 6 u^l_{ijk}}{(\Delta x)^2}
\]</span></p>
<p>The heat equation becomes: <span class="math display">\[
u^{l+1}_{ijk} = u^l_{ijk} + \frac{\alpha \Delta t}{\Delta x^2}
    \left(u^l_{i+1 jk} + u^l_{i-1 jk} + u^l_{ij+1k} + u^l_{ij-1k} + u^l_{ijk+1} + u^l_{ijk-1} - 6 u^l_{ijk} \right)
\]</span> Basically, this equation gives us a method for finding the temperature after a time step given the temperature at the previous time step. I will define the dimensionless constant <span class="math inline">\(\gamma\)</span> as follows:</p>
<p><span class="math display">\[
\gamma = \frac{\alpha \Delta t}{\Delta x^2}
\]</span></p>
<p>so we finally obtain: <span class="math display">\[
u^{l+1}_{ijk} = u^l_{ijk} + \gamma \left(u^l_{i+1 jk} + u^l_{i-1 jk} + u^l_{ij+1k} +
      u^l_{ij-1k} + u^l_{ijk+1} + u^l_{ijk-1} - 6 u^l_{ijk} \right)
\]</span></p>
<p>Now I will convert this to code:</p>
<div id="5a8d57a8" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>gamma <span class="op">=</span> alpha<span class="op">*</span>Deltat<span class="op">/</span>Deltax<span class="op">**</span><span class="dv">2</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calcHeatEqn(umat):</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    tm, xm, ym, zm <span class="op">=</span> umat.shape</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply BCs</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    umat <span class="op">=</span> applyBC(umat, <span class="dv">0</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,tm<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, xm<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, ym<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, zm<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>            umat[l<span class="op">+</span><span class="dv">1</span>,i,j,k] <span class="op">=</span> umat[l,i,j,k] <span class="op">+</span> gamma <span class="op">*</span> (umat[l,i<span class="op">+</span><span class="dv">1</span>,j,k] <span class="op">+</span> </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>                  umat[l,i<span class="op">-</span><span class="dv">1</span>,j,k] <span class="op">+</span> umat[l,i,j<span class="op">+</span><span class="dv">1</span>,k] <span class="op">+</span> umat[l,i,j<span class="op">-</span><span class="dv">1</span>,k] <span class="op">+</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>                  umat[l,i,j,k<span class="op">+</span><span class="dv">1</span>] <span class="op">+</span> umat[l,i,j,k<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> <span class="dv">6</span> <span class="op">*</span> umat[l,i,j,k])</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>      umat <span class="op">=</span> applyBC(umat, l<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> umat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualizing-the-temperature" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-temperature">Visualizing the temperature:</h3>
<p>The grid will probably be too fine to visualize well on a 3d heatmap. So I’ll settle for some cross sections. The function <code>plotheatmaps</code> will plot heat maps inside the box for a given time in 3 perpendicular planes.</p>
<div id="02075b91" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plotheatmaps(umat,l,i,j,k):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  Tmin <span class="op">=</span> np.<span class="bu">min</span>([u.<span class="bu">min</span>(),T0<span class="op">-</span>DT])</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  Tmax <span class="op">=</span> np.<span class="bu">max</span>([u.<span class="bu">max</span>(),T0<span class="op">+</span>DT])</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  xSlice <span class="op">=</span> umat[l,i,:,:].transpose()</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  ySlice <span class="op">=</span> umat[l,:,j,:].transpose()</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  zSlice <span class="op">=</span> umat[l,:,:,k].transpose()</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  time <span class="op">=</span> Deltat<span class="op">*</span>l</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  tMins <span class="op">=</span> time <span class="op">//</span> <span class="dv">60</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  theMinutes <span class="op">=</span> tMins <span class="op">%</span> <span class="dv">60</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  tHours <span class="op">=</span> tMins <span class="op">//</span> <span class="dv">60</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  theDays <span class="op">=</span> tHours <span class="op">//</span> <span class="dv">24</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  theHours <span class="op">=</span> tHours <span class="op">%</span> <span class="dv">24</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  theTime <span class="op">=</span> <span class="bu">str</span>(theDays) <span class="op">+</span> <span class="st">" days "</span> <span class="op">+</span> <span class="bu">str</span>(theHours) <span class="op">+</span> <span class="st">" hrs "</span>  <span class="op">+</span> <span class="bu">str</span>(theMinutes) <span class="op">+</span> <span class="st">" min"</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  xC, yC, zC <span class="op">=</span> [Deltax<span class="op">*</span>i, Deltax<span class="op">*</span>j, Deltax<span class="op">*</span>k]</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  fig, (ax0,ax1,ax2) <span class="op">=</span> plt.subplots(ncols<span class="op">=</span><span class="dv">3</span>,width_ratios<span class="op">=</span>[ymax,xmax,xmax],</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>              figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">3</span>))</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  fig.suptitle(<span class="ss">f"Heatbox Temp at </span><span class="sc">{</span>theTime<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="ss"> Outdoor Temp = </span><span class="sc">{</span>vair(T0,DT,time)<span class="sc">:.2f}</span><span class="ss"> C </span><span class="ch">\n</span><span class="ss"> Ground Temp = </span><span class="sc">{</span>vground(TG,time)<span class="sc">:.0f}</span><span class="ss"> C"</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  im0 <span class="op">=</span> ax0.pcolormesh(ygrid, zgrid, xSlice, shading<span class="op">=</span><span class="st">"flat"</span>, vmin <span class="op">=</span> Tmin, vmax <span class="op">=</span> Tmax)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  ax0.set_aspect(<span class="dv">1</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  ax0.set_title(<span class="ss">f"x = </span><span class="sc">{</span>xC<span class="sc">:.3f}</span><span class="ss"> m"</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  ax0.set_xlabel(<span class="st">"y"</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  ax0.set_ylabel(<span class="st">"z"</span>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  im1 <span class="op">=</span> ax1.pcolormesh(xgrid, zgrid, ySlice, shading<span class="op">=</span><span class="st">"flat"</span>, vmin <span class="op">=</span> Tmin, vmax <span class="op">=</span> Tmax)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  ax1.set_aspect(<span class="dv">1</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  ax1.set_title(<span class="ss">f"y = </span><span class="sc">{</span>yC<span class="sc">:.3f}</span><span class="ss"> m"</span>)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  ax1.set_xlabel(<span class="st">"x"</span>)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  ax1.set_ylabel(<span class="st">"z"</span>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  im2 <span class="op">=</span> ax2.pcolormesh(xgrid, ygrid, zSlice, shading<span class="op">=</span><span class="st">"flat"</span>, vmin <span class="op">=</span> Tmin, vmax <span class="op">=</span> Tmax)</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  ax2.set_aspect(<span class="dv">1</span>)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  ax2.set_title(<span class="ss">f"z = </span><span class="sc">{</span>zC<span class="sc">:.3f}</span><span class="ss"> m"</span>)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  ax2.set_xlabel(<span class="st">"x"</span>)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  ax2.set_ylabel(<span class="st">"y"</span>)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>  fig.tight_layout()</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  cax <span class="op">=</span> fig.add_axes([ax0.get_position().x0,ax0.get_position().y0<span class="op">-</span><span class="fl">0.2</span>,</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>                ax2.get_position().x1 <span class="op">-</span> ax0.get_position().x0, <span class="fl">0.02</span>])</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  fig.colorbar(im2, cax <span class="op">=</span> cax, orientation<span class="op">=</span><span class="st">'horizontal'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>So the initial condition has the following heatmap:</p>
<div id="f7630514" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>plotheatmaps(u,<span class="dv">0</span>,xmid,ymid,zmid)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>plotheatmaps(uAlt,<span class="dv">0</span>,xmid,ymid,zmid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-9-output-1.png" width="757" height="322" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-9-output-2.png" width="757" height="322" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-results" class="level2">
<h2 class="anchored" data-anchor-id="sec-results">Results</h2>
<p>Finally, we will compute the time evolution of the temperature for the two scenarios.</p>
<div id="3fafa784" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> calcHeatEqn(u)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>uAlt <span class="op">=</span> calcHeatEqn(uAlt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="different-initial-condition-comparison" class="level3">
<h3 class="anchored" data-anchor-id="different-initial-condition-comparison">Different initial condition comparison</h3>
<p>I’m going to start by comparing the behavior of the system given different initial conditions for the starting temperature within the box. The hidden code below crunches the average temperatures for the plots in this and the following sections.</p>
<div id="6f430d76" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Calculate averages at every time step</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>airTemp <span class="op">=</span> np.zeros(tmax)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>groundTemp <span class="op">=</span> np.zeros(tmax)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>boxTemp <span class="op">=</span> np.zeros(tmax)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>btErr <span class="op">=</span> np.zeros(tmax)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>boxTempAlt <span class="op">=</span> np.zeros(tmax)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>btaErr <span class="op">=</span> np.zeros(tmax)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>boxTempZ <span class="op">=</span> np.zeros((tmax,zmax))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>btzErr <span class="op">=</span> np.zeros((tmax,zmax))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> l <span class="kw">in</span> <span class="bu">range</span>(tmax):</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  airTemp[l] <span class="op">=</span> vair(T0,DT,t[l])</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  groundTemp[l] <span class="op">=</span> vground(TG,t[l])</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  ul <span class="op">=</span> u[l, :, :, :]</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  ulAlt <span class="op">=</span> uAlt[l, :, :, :]</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  boxTemp[l] <span class="op">=</span> np.mean(ul)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  boxTempAlt[l] <span class="op">=</span> np.mean(ulAlt)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  btErr[l] <span class="op">=</span> np.std(ul)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  btaErr[l] <span class="op">=</span> np.std(ulAlt)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(zmax):</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    ulk <span class="op">=</span> ul[:,:,k]</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    boxTempZ[l,k] <span class="op">=</span> np.mean(ulk)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    btzErr[l,k] <span class="op">=</span> np.std(ulk)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">## Calcs for temp in the day</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>stepsInDay <span class="op">=</span> <span class="bu">int</span>(oneDay<span class="op">/</span>Deltat)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>days <span class="op">=</span> <span class="bu">int</span>(T<span class="op">/</span>oneDay)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>day <span class="op">=</span> np.arange(<span class="dv">0</span>,days)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>boxTempDay <span class="op">=</span> np.zeros(days)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>btdErr <span class="op">=</span> np.zeros(days)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>boxTempDayAlt <span class="op">=</span> np.zeros(days)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>btdaErr <span class="op">=</span> np.zeros(days)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>boxTempDayZ <span class="op">=</span> np.zeros((days,zmax))</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>btdzErr <span class="op">=</span> np.zeros((days,zmax))</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> d <span class="kw">in</span> <span class="bu">range</span>(days):</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>    lmin <span class="op">=</span> <span class="bu">int</span>(d<span class="op">*</span>stepsInDay)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    lmax <span class="op">=</span> <span class="bu">int</span>((d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>stepsInDay)</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    ul <span class="op">=</span> u[lmin:lmax, :, :, :]</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    boxTempDay[d] <span class="op">=</span> np.mean(u[lmin:lmax, :, :, :])</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    boxTempDayAlt[d] <span class="op">=</span> np.mean(uAlt[lmin:lmax, :, :, :])</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>    btdErr[d] <span class="op">=</span> np.std(u[lmin:lmax, :, :, :])</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>    btdaErr[d] <span class="op">=</span> np.std(uAlt[lmin:lmax, :, :, :])</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(zmax):</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>        boxTempDayZ[d,k] <span class="op">=</span> np.mean(ul[:,:,:,k])</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>        btdzErr[d,k] <span class="op">=</span> np.std(ul[:,:,:,k])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>As noted previously, after a long enough time, I expect two identical boxes to exhibit the same behavior regardless of their initial conditions–much in the way that the long-term behavior of a Damped-Driven Oscillator is independent of the initial conditions. Let’s check that out here:</p>
<div id="8e44cdba" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fig, (ax0, ax1) <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">4</span>),sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ax0.plot(t,boxTemp, <span class="st">'-'</span>, label<span class="op">=</span><span class="vs">rf"</span><span class="dv">$</span><span class="vs">T_i=</span><span class="dv">$</span><span class="sc">{</span>u_init<span class="sc">:.0f}</span><span class="vs">"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ax0.plot(t,boxTempAlt, <span class="st">'--'</span>, label<span class="op">=</span><span class="vs">rf"</span><span class="dv">$</span><span class="vs">T_i=</span><span class="dv">$</span><span class="sc">{</span>uAlt_init<span class="sc">:.0f}</span><span class="vs">"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>ax0.set_xlabel(<span class="st">'Time (s)'</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>ax0.set_ylabel(<span class="st">'Temperature (deg C)'</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>ax0.legend()</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>ax1.plot(day,boxTempDay, <span class="st">'o'</span>, label<span class="op">=</span><span class="vs">rf"</span><span class="dv">$</span><span class="vs">T_i=</span><span class="dv">$</span><span class="sc">{</span>u_init<span class="sc">:.0f}</span><span class="vs">"</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>ax1.plot(day,boxTempDayAlt, <span class="st">'s'</span>, label<span class="op">=</span><span class="vs">rf"</span><span class="dv">$</span><span class="vs">T_i=</span><span class="dv">$</span><span class="sc">{</span>uAlt_init<span class="sc">:.0f}</span><span class="vs">"</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Time (days)'</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Temperature (deg C)'</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-12-output-1.png" width="659" height="356" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>It would seem that the 10 days that I have simulated is long enough for these systems to reach this “steady state” solution.</p>
</section>
<section id="compare-interior-temperature-to-exterior-temp" class="level3">
<h3 class="anchored" data-anchor-id="compare-interior-temperature-to-exterior-temp">Compare interior temperature to exterior temp</h3>
<p>I’m going to plot the external (air) temperature and compare it to the average temperature in the box, as well as consider the average temperature in horizontal slices as the change in time.</p>
<div id="a655e492" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="fl">6.5</span>,<span class="dv">4</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.plot(t,airTemp,label<span class="op">=</span><span class="st">"Air Temp"</span>,ls<span class="op">=</span><span class="st">'dashed'</span>,linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>plt.errorbar(t,boxTemp,yerr<span class="op">=</span>btErr, label<span class="op">=</span><span class="st">"Avg. Box Temp"</span>,linewidth<span class="op">=</span><span class="dv">2</span>, capsize<span class="op">=</span><span class="dv">2</span>, errorevery<span class="op">=</span><span class="dv">24</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Time (s)'</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Temperature (deg C)'</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">reversed</span>(<span class="bu">range</span>(<span class="dv">0</span>,zmax,zmax<span class="op">//</span><span class="dv">5</span>)):</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    zval <span class="op">=</span> k<span class="op">*</span>Deltax</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    labString <span class="op">=</span> <span class="ss">f"Avg Temp at z=</span><span class="sc">{</span>zval<span class="sc">:.2f}</span><span class="ss"> m"</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    plt.plot(t,boxTempZ[:,k],label<span class="op">=</span>labString, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>plt.plot(t,groundTemp,label<span class="op">=</span><span class="st">"Ground Temp"</span>,ls<span class="op">=</span><span class="st">"dashed"</span>,linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"center left"</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.04</span>,<span class="fl">0.5</span>))</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-13-output-1.png" width="773" height="356" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Just to see that this is stabilizing, and to get an idea of how fast this stabilizes, I’m going to find a daily average temperature as above.</p>
<div id="4afd67ba" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">4</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>plt.errorbar(day,boxTempDay,yerr<span class="op">=</span>btdErr, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Avg. Box Temp"</span>,capsize<span class="op">=</span><span class="dv">2</span>,linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Time (days)'</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Temperature (deg C)'</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">reversed</span>(<span class="bu">range</span>(<span class="dv">0</span>,zmax,zmax<span class="op">//</span><span class="dv">5</span>)):</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    zval <span class="op">=</span> k<span class="op">*</span>Deltax</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    labString <span class="op">=</span> <span class="ss">f"Avg Temp at z=</span><span class="sc">{</span>zval<span class="sc">:.2f}</span><span class="ss"> m"</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    plt.plot(day,boxTempDayZ[:,k], marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span>labString) </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-14-output-1.png" width="659" height="356" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="heatmaps" class="level3">
<h3 class="anchored" data-anchor-id="heatmaps">Heatmaps</h3>
<p>Let’s view the middle cross sections every few hours on the last day:</p>
<div id="abf64b23" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> s <span class="kw">in</span> <span class="bu">range</span>(lmin,lmax,<span class="bu">int</span>(stepsInDay<span class="op">/</span><span class="dv">12</span>)):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  plotheatmaps(u,s,xmid,ymid,zmid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-15-output-1.png" width="757" height="322" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-15-output-2.png" width="757" height="322" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-15-output-3.png" width="757" height="322" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-15-output-4.png" width="757" height="322" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-15-output-5.png" width="757" height="322" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-15-output-6.png" width="757" height="322" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-15-output-7.png" width="757" height="322" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-15-output-8.png" width="757" height="322" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-15-output-9.png" width="757" height="322" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-15-output-10.png" width="757" height="322" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-15-output-11.png" width="757" height="322" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="modelHeatFlow_files/figure-html/cell-15-output-12.png" width="757" height="322" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>This is working as a proof of concept. Job 1: Done. But there’s more to be done.</p>
<section id="next-step" class="level3">
<h3 class="anchored" data-anchor-id="next-step">Next step</h3>
<p>As a torture device, this leaves much to be desired. Right now, it’s no more effective than a chain-link fence from a temperature perspective. I’ll be working on adding in solar radiation in the next post.</p>
</section>
<section id="my-future-plans" class="level3">
<h3 class="anchored" data-anchor-id="my-future-plans">My future plans:</h3>
<p>As I seek to make this model more complex. I plan to do things that will slowly make my boring box look more like a house. Things like:</p>
<ul>
<li>Making the box house sized and adding an appropriate number of windows.</li>
<li>Add in interior walls.</li>
<li>Add in heating and cooling.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/datawolf04\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>