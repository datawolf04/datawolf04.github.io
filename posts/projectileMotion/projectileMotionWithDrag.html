<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Steven Wolf">
<meta name="dcterms.date" content="2025-03-06">
<meta name="description" content="Physics 1 physics vs.&nbsp;real world physics. Sorry, the world isn’t filled with spherical cows in a vacuum">

<title>Ready, Aim, Compute! – Steven Wolf - Data World</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-0b90554db41e1e94df75aa9c52e681fd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Steven Wolf - Data World</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://datawolf04.github.io/crossCountryMeetSummaries/"> 
<span class="menu-text">Cross Country</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/steven-wolf-253b6625a"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/datawolf04/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Ready, Aim, Compute!</h1>
                  <div>
        <div class="description">
          Physics 1 physics vs.&nbsp;real world physics. Sorry, the world isn’t filled with spherical cows in a vacuum
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Python</div>
                <div class="quarto-category">Modeling</div>
                <div class="quarto-category">Classes</div>
                <div class="quarto-category">Motion</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Steven Wolf </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 6, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#a-typical-physics-1-projectile-motion-problem" id="toc-a-typical-physics-1-projectile-motion-problem" class="nav-link active" data-scroll-target="#a-typical-physics-1-projectile-motion-problem">A typical Physics 1 projectile motion problem</a>
  <ul class="collapse">
  <li><a href="#ideal-projectile-motion-thinking-about-code" id="toc-ideal-projectile-motion-thinking-about-code" class="nav-link" data-scroll-target="#ideal-projectile-motion-thinking-about-code">Ideal Projectile Motion: Thinking about code</a></li>
  </ul></li>
  <li><a href="#air-resistance-its-a-drag." id="toc-air-resistance-its-a-drag." class="nav-link" data-scroll-target="#air-resistance-its-a-drag.">Air resistance: It’s a drag.</a>
  <ul class="collapse">
  <li><a href="#thinking-about-code" id="toc-thinking-about-code" class="nav-link" data-scroll-target="#thinking-about-code">Thinking about code</a></li>
  </ul></li>
  <li><a href="#comparing-motion-withwithout-air-resistance" id="toc-comparing-motion-withwithout-air-resistance" class="nav-link" data-scroll-target="#comparing-motion-withwithout-air-resistance">Comparing motion with/without air resistance</a>
  <ul class="collapse">
  <li><a href="#where-to-go-from-here" id="toc-where-to-go-from-here" class="nav-link" data-scroll-target="#where-to-go-from-here">Where to go from here</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="quarto-layout-panel" data-layout="[75, 25]">
<div class="quarto-layout-row">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<p>I’ve stalled out a bit on my heat equation modeling project because I’ve been thinking about ways to make it better. Also, I’ve been busy with the real world. So I thought I’d adapt something that I’ve used in class and post it here. Plus, I can’t let my students have <em><em>all</em></em> the fun, right? In the standard treatment, we often make approximations that may or may not be valid, and never test these approximations. In fact, that’s why we physicists often get made fun of, because we are talking about spherical cows. I like to get my students to think beyond spherical cows and give them tools to examine the limits of these approximations. So I’m going to build the models, and then play around a bit.</p>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.sphericalcowblog.com/spherical-cows"><img src="spherical-cow.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
</div>
</div>
<section id="a-typical-physics-1-projectile-motion-problem" class="level2">
<h2 class="anchored" data-anchor-id="a-typical-physics-1-projectile-motion-problem">A typical Physics 1 projectile motion problem</h2>
<p>I’ve given this problem (or variations of it) in my physics class for years:</p>
<blockquote class="blockquote">
<p>While on a vacation to Kenya, you visit the port city of Mombassa on the Indian Ocean. On the coast, you find an old Portuguese fort probably built in the 16th century. Large stone walls rise vertically from the shore to protect the fort from cannon fire from pirate ships. You wonder how close a pirate ship would have to sail to the fort to be in range of the fort’s cannon. Of course you realize that the range depends on the velocity that the cannonball leaves the cannon, as well as the height of the cliff.</p>
</blockquote>
<p>Usually, we set up a coordinate system like the picture below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="systemFig.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<p>Using this coordinate system, we can determine the equations of motion as follows:</p>
<p><span class="math display">\[
\begin{align*}
a_x(t) = \frac{dv_x}{dt} &amp;= 0 \\
a_y(t) = \frac{dv_y}{dt} &amp;= -g \\
\end{align*}
\]</span></p>
<p>These are integrated to find the velocity with the condition: <span class="math inline">\(\vec{v}_i = (v_i\cos\theta, v_i\sin\theta) = (v_x(0),v_y(0))\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
v_x(t) = \frac{dx}{dt} &amp;= v_i \cos\theta t \\
v_y(t) = \frac{dy}{dt} &amp;= v_i \sin\theta t - gt \\
\end{align*}
\]</span></p>
<p>These are integrated again to find the position with the condition: <span class="math inline">\(\vec{r}_i = (0,H) = (x(0),y(0))\)</span></p>
<p><span class="math display">\[
\begin{align*}
x(t) &amp;= v_i \cos\theta t \\
y(t) &amp;= H + v_i\sin\theta t - \frac{1}{2}gt^2 \\
\end{align*}
\]</span></p>
<p>We are also interested in the time of flight (i.e., How long the projectile is in the air):</p>
<p><span class="math display">\[
y(T) = 0 = H + v_i \sin\theta T - \frac{1}{2} gT^2 \implies T = \frac{v_i\sin\theta + \sqrt{v_i^2 \sin^2\theta + 2gH}}{g}
\]</span></p>
<p>(Note, since the projectile is launched at <span class="math inline">\(t=0\)</span>, we expect the time of flight <span class="math inline">\(T&gt;0\)</span>, so I have thrown out the negative solution for <span class="math inline">\(T\)</span> in the equation above.)</p>
<p>And the range<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> of the projectile: <span class="math display">\[
D = x(T) = v_i\cos\theta T = v_i \cos\theta \frac{v_i\sin\theta + \sqrt{v_i^2 \sin^2\theta + 2gH}}{g}
\]</span></p>
<p>This allows us to give physics students problems, and get them to calculate things. We also say that the motion of the cannonball is <em>parabolic</em>, and a bunch of other stuff that only works if we are talking about spherical cows flying around in vacuum. Anyone who has seen a shot tracer of a golf ball will say that these don’t look like the parabolas we all drew back in High School Algebra classes. So what’s going on?</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="shotTracer.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<section id="ideal-projectile-motion-thinking-about-code" class="level3">
<h3 class="anchored" data-anchor-id="ideal-projectile-motion-thinking-about-code">Ideal Projectile Motion: Thinking about code</h3>
<p>At this point, we have fully specified the problem. Any motion is fully specified given the cliff height <span class="math inline">\(H\)</span>, launch speed <span class="math inline">\(v_i\)</span>, and launch angle <span class="math inline">\(\theta\)</span>. We are done. Computationally, we want to be able to calculate all the important things, and define all of the important functions. I have chosen to use a python <em>class</em> to do so. The nice thing about using classes is that you can specify all of the variables for the system, but not have them cluttering the working environment.</p>
<div id="592037b2" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> idealProjectile:</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">'''</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">  Does the standard Physics 1 treatment of a projectile on earth for a projectile </span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">  fired from an elevated position</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">  Inputs:</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">    vLaunchMag = launch speed in m/s</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">    vLaunchDir = launch angle measured from horizontal in degrees</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">    height = elevation of the position in m</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">  Outputs: (All in SI units)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">    tof = time of flight in seconds</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">    maxX = range of projectile in m</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">    position = function that calculates vector position as a function of time</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">    velocity = function that calculates vector velocity as a function of time</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">    acceleration = function that calculates vector acceleration as a function of time</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">  '''</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, vLaunchMag, vLaunchDir, height):</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.v0 <span class="op">=</span> vLaunchMag</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    theta <span class="op">=</span> np.pi<span class="op">/</span><span class="dv">180</span><span class="op">*</span><span class="bu">float</span>(vLaunchDir)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.theta <span class="op">=</span> theta</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.h <span class="op">=</span> height</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.g <span class="op">=</span> <span class="fl">9.81</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> <span class="va">self</span>.g</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    v0x <span class="op">=</span> vLaunchMag<span class="op">*</span>np.cos(theta)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    v0y <span class="op">=</span> vLaunchMag<span class="op">*</span>np.sin(theta)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.tof <span class="op">=</span> (v0y <span class="op">+</span> np.sqrt(v0y<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>g<span class="op">*</span>height))<span class="op">/</span>g</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.maxX <span class="op">=</span> v0x <span class="op">*</span> <span class="va">self</span>.tof</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> position(<span class="va">self</span>, t):</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    v0, theta, g, h <span class="op">=</span> <span class="va">self</span>.v0, <span class="va">self</span>.theta, <span class="va">self</span>.g, <span class="va">self</span>.h</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    v0x <span class="op">=</span> v0<span class="op">*</span>np.cos(theta)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    v0y <span class="op">=</span> v0<span class="op">*</span>np.sin(theta)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> v0x <span class="op">*</span> t</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> h <span class="op">+</span> v0y<span class="op">*</span>t <span class="op">-</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span> <span class="op">*</span> g <span class="op">*</span> t<span class="op">**</span><span class="dv">2</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [x,y]</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> velocity(<span class="va">self</span>,t):</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    v0, theta, g <span class="op">=</span> <span class="va">self</span>.v0, <span class="va">self</span>.theta, <span class="va">self</span>.g</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    v0x <span class="op">=</span> v0<span class="op">*</span>np.cos(theta)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    v0y <span class="op">=</span> v0<span class="op">*</span>np.sin(theta)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    vx <span class="op">=</span> v0x</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    vy <span class="op">=</span> v0y <span class="op">-</span> g<span class="op">*</span>t</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [vx,vy]</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> acceleration(<span class="va">self</span>,t):</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="dv">0</span>,<span class="op">-</span><span class="va">self</span>.g]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="air-resistance-its-a-drag." class="level2">
<h2 class="anchored" data-anchor-id="air-resistance-its-a-drag.">Air resistance: It’s a drag.</h2>
<p>When we model motion in a fluid, for large, fast objects we can write:</p>
<p><span class="math display">\[
\vec{F}_{\text{air}} = -c \left|\vec{v}\right|\vec{v} = -c \sqrt{v_x(t)^2+v_y(t)^2} (v_x(t), v_y(t))
\]</span> where the coefficient <span class="math inline">\(c\)</span> is a constant that depends on the size and shape of the object moving through air, as well as the density of the fluid. This model can get more complicated, and <a href="https://en.wikipedia.org/wiki/Drag_(physics)">wikipedia</a> discusses it further at a reasonably intro-level. But I won’t bore you here.</p>
<p>Including this in our model for projectile motion allows us to generate new equations of motion, and this can be done for all levels of physics.</p>
<p><span class="math display">\[
\begin{align*}
a_x(t) = \frac{dv_x}{dt} &amp;= - \frac{c}{m} \sqrt{v_x^2+v_y^2} v_x\\
a_y(t) = \frac{dv_y}{dt} &amp;= -g - \frac{c}{m} \sqrt{v_x^2+v_y^2} v_y\\
\end{align*}
\]</span></p>
<p>These are integrated to find the velocity with the condition: <span class="math inline">\(\vec{v}_i = (v_i\cos\theta, v_i\sin\theta) = (v_x(0),v_y(0))\)</span>, and we get…an error.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="error404.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:30.0%"></p>
</figure>
</div>
<p>Well, we can integrate these equations if we use, well, I’ll let Katherine Johnson’s character from the movie <em>Hidden Figures</em> tell you:</p>
<div style="text-align:center">
<iframe width="400" height="315" allowfullscreen="" src="https://www.youtube.com/embed/8xPRn9weLYg?si=IgIhM9ozVqNLZxMs">
</iframe>
</div>
<p>We won’t actually use Euler’s method, but instead use the default method in Python’s <code>scipy.integrate.solve_ivp</code> function - <a href="https://doi.org/10.1016/0771-050X(80)90013-3">an application of the Runge-Kutta method</a> which is still pretty ancient. (Well, it’s older than me!) I won’t be going into the details of the method here.</p>
<p>The level of the class that I’m teaching determines how I proceed from here. If we have an upper level class, students use the numeric integrator of their choice, be it in Mathematica, Matlab, Python, or something else. In an intro class, I walk through Euler (or Euler-Cromer) integration with them. (And they will have seen a 1D implementation of Euler’s method before we tackle this 2D version.)</p>
<section id="thinking-about-code" class="level3">
<h3 class="anchored" data-anchor-id="thinking-about-code">Thinking about code</h3>
<p>Once we add the projectile mass <span class="math inline">\(m\)</span>, and drag coefficient <span class="math inline">\(c\)</span> to the parameters that we had for the the ideal motion, <span class="math inline">\(H\)</span>, <span class="math inline">\(v_i\)</span>, and <span class="math inline">\(\theta\)</span>, we have fully specified the problem. Despite the fact that we cannot integrate the equations of motion analytically, we can do so numerically. As before, I have chosen to use a python <em>class</em> to carry this out. Actually, I’ve created <em>two</em> classes to do this. Let’s go into the why for this choice in the next sections.</p>
<section id="a-note-about-integrating-differential-equations-numerically" class="level4">
<h4 class="anchored" data-anchor-id="a-note-about-integrating-differential-equations-numerically">A note about integrating differential equations numerically</h4>
<p>In physics, we use Newton’s laws to generate differential equations governing the motion of a system. Specifically, we get the acceleration, which is the <em>second derivative</em> of position. So if we want the position as a function of time for a system, this is a <em><em>2nd order</em></em> differential equation. However, numerical methods are built on solving <em><em>1st order</em></em> differential equations.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>Let’s think about the function <span class="math inline">\(u(t)\)</span> which returns a vector comprised of the position vector combined with the velocity vector.</p>
<p><span class="math display">\[
u(t) = \left[x(t), y(t), v_x(t), v_y(t) \right]
\]</span></p>
<p>We can take the time derivative of this function (I’ll use a dot to signify differentiation with respect to time) and express it in terms of the velocity and acceleration <span class="math display">\[
\dot{u}(t) = \left[\dot{x}(t), \dot{y}(t), \dot{v}_x(t), \dot{v}_y(t) \right] = \left[v_x(t), v_y(t), a_x(t), a_y(t)\right]
\]</span></p>
<p><code>dragEOM</code> is this function <span class="math inline">\(\dot{u}(t)\)</span> applied to our projectile system.</p>
<div id="dab1ccc2" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> dragEOM:</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">'''</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Equations of motion for projectile system with turbulent drag fired from an elevated position</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">  Inputs:</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">    vLaunchMag = launch speed in m/s</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">    vLaunchDir = launch angle measured from horizontal in degrees</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">    height = elevation of the position in m</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">    mass = mass of projectile in kg</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">    dragCoef = drag coefficient for system in kg/m</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">  Outputs:</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">    udot = [xdot, ydot, vxdot, vydot]</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">    splash = function that returns y coordinate (needed for integration)</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">  '''</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, vLaunchMag, vLaunchDir, height, mass, dragCoef):</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.v0 <span class="op">=</span> vLaunchMag</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      theta <span class="op">=</span> np.pi<span class="op">/</span><span class="dv">180</span><span class="op">*</span><span class="bu">float</span>(vLaunchDir)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.theta <span class="op">=</span> theta</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.h <span class="op">=</span> height</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.g <span class="op">=</span> <span class="fl">9.81</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      g <span class="op">=</span> <span class="va">self</span>.g</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.coef <span class="op">=</span> dragCoef<span class="op">/</span>mass</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      v0x <span class="op">=</span> vLaunchMag<span class="op">*</span>np.cos(theta)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>      v0y <span class="op">=</span> vLaunchMag<span class="op">*</span>np.sin(theta)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.idealTof <span class="op">=</span> (v0y <span class="op">+</span> np.sqrt(v0y<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>g<span class="op">*</span>height))<span class="op">/</span>g</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.u0 <span class="op">=</span> [<span class="dv">0</span>, height, v0x, v0y]</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>,t,u):</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>      g, coef <span class="op">=</span> <span class="va">self</span>.g, <span class="va">self</span>.coef</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>      x, y, vx, vy <span class="op">=</span> u</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>      xdot, ydot <span class="op">=</span> vx, vy</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>      vxdot <span class="op">=</span> <span class="op">-</span>coef <span class="op">*</span> np.sqrt(vx<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> vy<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> vx</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>      vydot <span class="op">=</span> <span class="op">-</span>g <span class="op">-</span> coef <span class="op">*</span> np.sqrt(vx<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> vy<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> vy</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>      udot <span class="op">=</span> [xdot, ydot, vxdot, vydot]</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> udot</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> splash(<span class="va">self</span>,t,u):</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> u[<span class="dv">1</span>]</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  splash.terminal <span class="op">=</span> <span class="va">True</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="getting-the-motion" class="level4">
<h4 class="anchored" data-anchor-id="getting-the-motion">Getting the motion</h4>
<p>Now that this is done, we can get the motion for this system using the following class:</p>
<div id="314a8716" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> dragProjectile:</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">'''</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">  Equations of motion for projectile system with turbulent drag fired from an elevated position</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Inputs:</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">    vLaunchMag = launch speed in m/s</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">    vLaunchDir = launch angle measured from horizontal in degrees</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">    height = elevation of the position in m</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">    mass = mass of projectile in kg</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">    dragCoef = drag coefficient for system in kg/m</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">  Outputs:</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">    t = vector of time values where the system is solved</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">    x, y = vectors of position values matching the time vector above</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">    vx, vy = vectors of velocity values matching the time vector above</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">    ax, ay = vectors of acceleration values matching the time vector above</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">    tof = time of flight </span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">    maxX = projectile range</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">  '''</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, vLaunchMag, vLaunchDir, height, mass, dragCoef):</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> dragEOM(vLaunchMag, vLaunchDir, height, mass, dragCoef)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    tMax <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> model.idealTof</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    tVals <span class="op">=</span> np.linspace(<span class="dv">0</span>,tMax,<span class="dv">100</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    u0 <span class="op">=</span> model.u0</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    sol <span class="op">=</span> solve_ivp(model, t_span<span class="op">=</span>[<span class="dv">0</span>,tMax], y0 <span class="op">=</span> u0, t_eval<span class="op">=</span>tVals, events<span class="op">=</span>model.splash, dense_output<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.tof <span class="op">=</span> sol.t_events[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.maxX <span class="op">=</span> sol.y_events[<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.t <span class="op">=</span> sol.t</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.x <span class="op">=</span> sol.y[<span class="dv">0</span>, :]</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.y <span class="op">=</span> sol.y[<span class="dv">1</span>, :]</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.vx <span class="op">=</span> sol.y[<span class="dv">2</span>, :]</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.vy <span class="op">=</span> sol.y[<span class="dv">3</span>, :]</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    udot <span class="op">=</span> model(sol.t, sol.y)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.ax <span class="op">=</span> udot[<span class="dv">2</span>]</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.ay <span class="op">=</span> udot[<span class="dv">3</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
</section>
<section id="comparing-motion-withwithout-air-resistance" class="level2">
<h2 class="anchored" data-anchor-id="comparing-motion-withwithout-air-resistance">Comparing motion with/without air resistance</h2>
<p>Now that we have these tools built, we can start to visualize this motion. I’ll do this using some functions in my <code>projectile.py</code> file to make graphs. I will also include the following numerical values:</p>
<ul>
<li><span class="math inline">\(H = 200\)</span> m</li>
<li><span class="math inline">\(v_i = 100\)</span> m/s</li>
<li><span class="math inline">\(\theta = 30\)</span> deg</li>
<li><span class="math inline">\(m = 1\)</span> kg</li>
<li><span class="math inline">\(c = 0.003\)</span> kg/m</li>
</ul>
<div id="06055768" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> projectile <span class="im">import</span> <span class="op">*</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>vi <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>theta <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fl">0.003</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>I will visualize this motion in two ways. First, I’ll plot each quantity of the motion (position, velocity, acceleration) vs.&nbsp;time.</p>
<div id="4af973ab" class="cell" width="75%" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>plotCannonCurves(vi,theta,H,m,c)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="projectileMotionWithDrag_files/figure-html/cell-6-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="715" height="953"></p>
</figure>
</div>
</div>
</div>
<p>Now I will plot the trajectory (y-coordinate vs x-coordinate). Note that I have added boxes to this plot indicating the cliff location and the water level to help guide the eye. The plot has also been set up with an equal aspect ratio so that the horizontal and vertical distances are the same. The green curve should more closely match the golf ball tracer than the red parabolic path does.</p>
<div id="689f5507" class="cell" width="75%" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>makeTrajectoryPlot(vi,theta,H,m,c)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="projectileMotionWithDrag_files/figure-html/cell-7-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="716" height="395"></p>
</figure>
</div>
</div>
</div>
<section id="where-to-go-from-here" class="level3">
<h3 class="anchored" data-anchor-id="where-to-go-from-here">Where to go from here</h3>
<p>Usually, I’ll give my students some tasks like finding the maximum range of the projectile, and comparing the model results. I thought that I would do something a little different as it will allow me to compare the model predictions. I will do this using the fractional difference between the two predictions for both the range and the time of flight. Since I used <span class="math inline">\(D\)</span> to denote the range, I will write <span class="math inline">\(D_1\)</span> to denote the range for model 1 (no air resistance) and <span class="math inline">\(D_2\)</span> to denote the range for model 2 (with air resistance). Therefore the quantity below is the fractional difference between the targeting location of the models.</p>
<p><span class="math display">\[
\delta_D = \frac{\left|D_1 - D_2\right|}{D_1}
\]</span></p>
<p>I will also define a similar quantity related to the time-of-flight.</p>
<p><span class="math display">\[
\delta_T = \frac{\left|T_2 - T_1\right|}{T_2}
\]</span></p>
<p>Note that I’m using <span class="math inline">\(D_1\)</span> in the denominator of <span class="math inline">\(\delta_D\)</span> and <span class="math inline">\(T_2\)</span> in the denominator of <span class="math inline">\(\delta_T\)</span>. This is because these are the larger values for each motion.</p>
<p>I will calculate these quantities for a range of launch velocities, masses, and launch angles keeping the cliff height <span class="math inline">\((H=100 \,\text{m})\)</span> and drag coefficient <span class="math inline">\((c=0.003 \,\text{kg/m})\)</span> the same as it was before.</p>
<div id="d143cb0b" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.colors <span class="im">as</span> mc</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.cm <span class="im">as</span> cm</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>launchVelocities <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">200</span>,<span class="dv">21</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>launchAngles <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">85</span>,<span class="dv">18</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>masses <span class="op">=</span> np.logspace(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">19</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>nv <span class="op">=</span> <span class="bu">len</span>(launchVelocities)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>na <span class="op">=</span> <span class="bu">len</span>(launchAngles)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>nm <span class="op">=</span> <span class="bu">len</span>(masses)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>deltaD <span class="op">=</span> np.empty(shape<span class="op">=</span>(nv,na,nm))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>deltaT <span class="op">=</span> np.empty(shape<span class="op">=</span>(nv,na,nm))</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(nv):</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(na):</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(nm):</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>      lv <span class="op">=</span> launchVelocities[i]</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>      la <span class="op">=</span> launchAngles[j]</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>      mm <span class="op">=</span> masses[k]</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>      m1 <span class="op">=</span> idealProjectile(lv,la,H)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>      m2 <span class="op">=</span> dragProjectile(lv,la,H,mm,c)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>      D1 <span class="op">=</span> m1.maxX</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>      D2 <span class="op">=</span> m2.maxX</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>      T1 <span class="op">=</span> m1.tof</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>      T2 <span class="op">=</span> m2.tof</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>      deltaT[i,j,k] <span class="op">=</span> np.<span class="bu">abs</span>(T1 <span class="op">-</span> T2)<span class="op">/</span>T2</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> D1<span class="op">&lt;</span><span class="dv">1</span> <span class="kw">and</span> D2 <span class="op">&lt;</span><span class="dv">1</span>:</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For small ranges (less than 1 meter from the cliff), just set the </span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># fractional difference equal to zero</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>        deltaD[i,j,k] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>:</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>        deltaD[i,j,k] <span class="op">=</span> np.<span class="bu">abs</span>(D1 <span class="op">-</span> D2)<span class="op">/</span>D1</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up properties of the color bar </span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>cnormD <span class="op">=</span> mc.Normalize(vmin<span class="op">=</span><span class="dv">0</span>,vmax<span class="op">=</span>deltaD.<span class="bu">max</span>())</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>cbarD <span class="op">=</span> cm.ScalarMappable(norm<span class="op">=</span>cnormD,cmap<span class="op">=</span><span class="st">'plasma'</span>)</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>cnormT <span class="op">=</span> mc.Normalize(vmin<span class="op">=</span><span class="dv">0</span>,vmax<span class="op">=</span>deltaT.<span class="bu">max</span>())</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>cbarT <span class="op">=</span> cm.ScalarMappable(norm<span class="op">=</span>cnormT)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange the calculations into multiple grids for making a heatmap/contour plot</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>X1, Y1 <span class="op">=</span> np.meshgrid(launchVelocities, launchAngles)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>Z1 <span class="op">=</span> deltaD[:, :, nm<span class="op">//</span><span class="dv">2</span>].transpose()</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>ZZ1 <span class="op">=</span> deltaT[:, :, nm<span class="op">//</span><span class="dv">2</span>].transpose()</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>X2, Y2 <span class="op">=</span> np.meshgrid(launchVelocities, masses)</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>Z2 <span class="op">=</span> deltaD[:, na<span class="op">//</span><span class="dv">2</span>, :].transpose()</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>ZZ2 <span class="op">=</span> deltaT[:, na<span class="op">//</span><span class="dv">2</span>, :].transpose()</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>X3, Y3 <span class="op">=</span> np.meshgrid(launchAngles, masses)</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>Z3 <span class="op">=</span> deltaD[nv<span class="op">//</span><span class="dv">2</span>, :, :].transpose()</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>ZZ3 <span class="op">=</span> deltaT[nv<span class="op">//</span><span class="dv">2</span>, :, :].transpose()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Now, let’s examine the model agreement for the range:</p>
<div id="18bb3c7b" class="cell" width="90%" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fig1, ax1 <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>,figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="dv">4</span>))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>fig1.suptitle(<span class="st">"Comparing predicted range with/without air resistance"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>CS <span class="op">=</span> ax1[<span class="dv">0</span>].contourf(X1,Y1,Z1,<span class="dv">100</span>,cmap<span class="op">=</span><span class="st">'plasma'</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">0</span>].set_title(<span class="ss">f'Mass = </span><span class="sc">{</span>masses[nm<span class="op">//</span><span class="dv">2</span>]<span class="sc">:.2f}</span><span class="ss"> kg'</span>,size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">0</span>].set_xlabel(<span class="st">'Launch velocity (m/s)'</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">0</span>].set_ylabel(<span class="st">'Launch angle (deg)'</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">1</span>].contourf(X2,Y2,Z2,<span class="dv">100</span>,cmap<span class="op">=</span><span class="st">'plasma'</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">1</span>].set_title(<span class="ss">f'Launch angle = </span><span class="sc">{</span>launchAngles[na<span class="op">//</span><span class="dv">2</span>]<span class="sc">:.0f}</span><span class="ss"> deg'</span>,size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">1</span>].set_xlabel(<span class="st">'Launch velocity (m/s)'</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">1</span>].set_ylabel(<span class="st">'Mass (kg)'</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">1</span>].set_yscale(<span class="st">'log'</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">2</span>].contourf(X3,Y3,Z3,<span class="dv">100</span>,cmap<span class="op">=</span><span class="st">'plasma'</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">2</span>].set_title(<span class="ss">f'Launch velocity = </span><span class="sc">{</span>launchVelocities[nv<span class="op">//</span><span class="dv">2</span>]<span class="sc">:.0f}</span><span class="ss"> m/s'</span>,size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">2</span>].set_xlabel(<span class="st">'Launch angle (deg)'</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">2</span>].set_ylabel(<span class="st">'Mass (kg)'</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">2</span>].set_yscale(<span class="st">'log'</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>fig1.subplots_adjust(bottom<span class="op">=</span><span class="fl">0.3</span>,wspace<span class="op">=</span><span class="fl">0.5</span>,right<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>cbar_ax <span class="op">=</span> fig1.add_axes([<span class="fl">0.2</span>, <span class="fl">0.15</span>, <span class="fl">0.65</span>, <span class="fl">0.02</span>])</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>fig1.colorbar(cbarD, cax<span class="op">=</span>cbar_ax,label<span class="op">=</span><span class="vs">r'</span><span class="dv">$\d</span><span class="vs">elta_D</span><span class="dv">$</span><span class="vs">'</span>,orientation<span class="op">=</span><span class="st">'horizontal'</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>ghLogo <span class="op">=</span> <span class="st">u"</span><span class="ch">\uf09b</span><span class="st">"</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>liLogo <span class="op">=</span> <span class="st">u"</span><span class="ch">\uf08c</span><span class="st">"</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>txt <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>ghLogo<span class="sc">}</span><span class="ss"> datawolf04 </span><span class="sc">{</span>liLogo<span class="sc">}</span><span class="ss"> steven-wolf-253b6625a"</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>plt.figtext(<span class="fl">0.6</span>,<span class="fl">0.01</span>, txt,family<span class="op">=</span>[<span class="st">'DejaVu Sans'</span>,<span class="st">'FontAwesome'</span>],fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'rangeCalcFracDiff.png'</span>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="projectileMotionWithDrag_files/figure-html/cell-9-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="650" height="395"></p>
</figure>
</div>
</div>
</div>
<p>Finally, I’ll examine the model agreement for the time-of-flight:</p>
<div id="749b5f6d" class="cell" width="90%" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fig1, ax1 <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>,figsize<span class="op">=</span>(<span class="dv">7</span>,<span class="dv">4</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fig1.suptitle(<span class="st">"Comparing predicted time of flight with/without air resistance"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>CS <span class="op">=</span> ax1[<span class="dv">0</span>].contourf(X1,Y1,ZZ1,<span class="dv">100</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">0</span>].set_title(<span class="ss">f'Mass = </span><span class="sc">{</span>masses[nm<span class="op">//</span><span class="dv">2</span>]<span class="sc">:.2f}</span><span class="ss"> kg'</span>,size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">0</span>].set_xlabel(<span class="st">'Launch velocity (m/s)'</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">0</span>].set_ylabel(<span class="st">'Launch angle (deg)'</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">1</span>].contourf(X2,Y2,ZZ2,<span class="dv">100</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">1</span>].set_title(<span class="ss">f'Launch angle = </span><span class="sc">{</span>launchAngles[na<span class="op">//</span><span class="dv">2</span>]<span class="sc">:.0f}</span><span class="ss"> deg'</span>,size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">1</span>].set_xlabel(<span class="st">'Launch velocity (m/s)'</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">1</span>].set_ylabel(<span class="st">'Mass (kg)'</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">1</span>].set_yscale(<span class="st">'log'</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">2</span>].contourf(X3,Y3,ZZ3,<span class="dv">100</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">2</span>].set_title(<span class="ss">f'Launch velocity = </span><span class="sc">{</span>launchVelocities[nv<span class="op">//</span><span class="dv">2</span>]<span class="sc">:.0f}</span><span class="ss"> m/s'</span>,size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">2</span>].set_xlabel(<span class="st">'Launch angle (deg)'</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">2</span>].set_ylabel(<span class="st">'Mass (kg)'</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">2</span>].set_yscale(<span class="st">'log'</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>fig1.subplots_adjust(bottom<span class="op">=</span><span class="fl">0.3</span>,wspace<span class="op">=</span><span class="fl">0.5</span>,right<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>cbar_ax <span class="op">=</span> fig1.add_axes([<span class="fl">0.2</span>, <span class="fl">0.15</span>, <span class="fl">0.65</span>, <span class="fl">0.02</span>])</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>fig1.colorbar(cbarT, cax<span class="op">=</span>cbar_ax,label<span class="op">=</span><span class="vs">r'</span><span class="dv">$\d</span><span class="vs">elta_T</span><span class="dv">$</span><span class="vs">'</span>,orientation<span class="op">=</span><span class="st">'horizontal'</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>ghLogo <span class="op">=</span> <span class="st">u"</span><span class="ch">\uf09b</span><span class="st">"</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>liLogo <span class="op">=</span> <span class="st">u"</span><span class="ch">\uf08c</span><span class="st">"</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>txt <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>ghLogo<span class="sc">}</span><span class="ss"> datawolf04 </span><span class="sc">{</span>liLogo<span class="sc">}</span><span class="ss"> steven-wolf-253b6625a"</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>plt.figtext(<span class="fl">0.6</span>,<span class="fl">0.01</span>, txt,family<span class="op">=</span>[<span class="st">'DejaVu Sans'</span>,<span class="st">'FontAwesome'</span>],fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'tofCalcFracDiff.png'</span>)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="projectileMotionWithDrag_files/figure-html/cell-10-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="650" height="395"></p>
</figure>
</div>
</div>
</div>
<p>Note that the color scales for these plots have different ranges. In particular the max <span class="math inline">\(\delta_T\)</span> value is larger than the max <span class="math inline">\(\delta_D\)</span> value. Given the initial height, it would seem that the time of flight is much more sensitive to air resistance. In general, areas on the plots above where the color is yellow shows a high level of disagreement between motion in vacuum vs.&nbsp;motion in air. Areas where the color is blue/violet shows a low level of disagreement between the models. Since air resistance is dependent on speed, we would expect that at low speeds, air resistance is less important, especially for the range calculation. Given the fact that gravity/weight is the other force of interest, objects with a larger mass are also less sensitive to air resistance.</p>
<p>There is an interesting “trough” in the time of flight graphic. You can see that the minimum <span class="math inline">\(\delta_T\)</span> values aren’t along one of the axes as they are for <span class="math inline">\(\delta_D\)</span>. This is because for very slow, or nearly vertical launch trajectories, the range isn’t going to be very different as it just doesn’t move very fast in the x-direction. Perhaps the best way to think about this is to compare the motion of a gently tossed pebble to a gently tossed feather from the same height. They both land in (about) the same place. So both have a small difference with the vacuum range. The time of flight will be different, since the feather stops going up sooner, and falls with an average acceleration much different than <span class="math inline">\(-g\)</span>. Yet the motion of the pebble will be much more similar to the vacuum motion since the drag force is much smaller in magnitude than the weight of the pebble.</p>
<section id="motion-of-a-feather-vs-a-pebble" class="level5">
<h5 class="anchored" data-anchor-id="motion-of-a-feather-vs-a-pebble">Motion of a “feather” vs a “pebble”</h5>
<div id="195841e5" class="cell" width="75%" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>vi <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>vdir <span class="op">=</span> <span class="dv">85</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>vacuum <span class="op">=</span> idealProjectile(vi,vdir,H)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>iTime <span class="op">=</span> np.linspace(<span class="dv">0</span>,vacuum.tof,<span class="dv">100</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>[iPosx, iPosy] <span class="op">=</span> vacuum.position(iTime)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>[iVelx, iVely] <span class="op">=</span> vacuum.velocity(iTime)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>[iAccx, iAccy] <span class="op">=</span> vacuum.acceleration(iTime)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>feather <span class="op">=</span> dragProjectile(vi,vdir,H,<span class="fl">.1</span>,c)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>pebble <span class="op">=</span> dragProjectile(vi,vdir,H,<span class="dv">10</span>,c)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>,figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">4</span>))</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="ss">f'Motion of ideal projectile, "feather", and "pebble" for </span><span class="ch">\n</span><span class="ss">'</span><span class="op">+</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f'launch velocity = </span><span class="sc">{</span>vi<span class="sc">:.0f}</span><span class="ss"> m/s and launch angle = </span><span class="sc">{</span>vdir<span class="sc">:.0f}</span><span class="ss"> deg'</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].axhline(iAccx,label<span class="op">=</span><span class="st">'vacuum'</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(feather.t, feather.ax,<span class="st">'r'</span>,label<span class="op">=</span><span class="st">'feather'</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(pebble.t, pebble.ax,<span class="st">'g'</span>,label<span class="op">=</span><span class="st">'pebble'</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'time (s)'</span>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="vs">r'</span><span class="dv">$</span><span class="vs">a_x</span><span class="dv">$</span><span class="vs"> </span><span class="kw">(</span><span class="vs">m/s</span><span class="dv">^</span><span class="vs">2</span><span class="kw">)</span><span class="vs">'</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend()</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].axhline(iAccy,label<span class="op">=</span><span class="st">'vacuum'</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(feather.t, feather.ay,<span class="st">'r'</span>,label<span class="op">=</span><span class="st">'feather'</span>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(pebble.t, pebble.ay,<span class="st">'g'</span>,label<span class="op">=</span><span class="st">'pebble'</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'time (s)'</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="vs">r'</span><span class="dv">$</span><span class="vs">a_y</span><span class="dv">$</span><span class="vs"> </span><span class="kw">(</span><span class="vs">m/s</span><span class="dv">^</span><span class="vs">2</span><span class="kw">)</span><span class="vs">'</span>)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylim(ax[<span class="dv">1</span>].get_ylim())</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].legend()</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(iPosx,iPosy, label<span class="op">=</span><span class="st">'vacuum'</span>)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(feather.x, feather.y,<span class="st">'r'</span>, label<span class="op">=</span><span class="st">'feather'</span>)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(pebble.x, pebble.y,<span class="st">'g'</span>,label<span class="op">=</span><span class="st">'pebble'</span>)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].axis(<span class="st">'equal'</span>)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlim([<span class="dv">0</span>,<span class="dv">200</span>])</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="vs">r'</span><span class="dv">$</span><span class="vs">x</span><span class="dv">$</span><span class="vs"> </span><span class="kw">(</span><span class="vs">m</span><span class="kw">)</span><span class="vs">'</span>)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_ylabel(<span class="vs">r'</span><span class="dv">$</span><span class="vs">y</span><span class="dv">$</span><span class="vs"> </span><span class="kw">(</span><span class="vs">m</span><span class="kw">)</span><span class="vs">'</span>)</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].legend()</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>fig.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.4</span>,bottom<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>plt.figtext(<span class="fl">0.65</span>,<span class="fl">0.01</span>, txt,family<span class="op">=</span>[<span class="st">'DejaVu Sans'</span>,<span class="st">'FontAwesome'</span>],fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="projectileMotionWithDrag_files/figure-html/cell-11-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="771" height="394"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>No, that’s not the “range equation” found in standard physics textbooks. And no, I haven’t made a mistake. The “range equation” in the standard physics text assumes <span class="math inline">\(H=0\)</span>, that is, there is no elevation change to be concerned about. We can reduce this if we set <span class="math inline">\(H=0\)</span>. In this case, <span class="math inline">\(T = \frac{2 v_i \sin\theta}{g}\)</span> and <span class="math inline">\(D = \frac{2 v_i^2 \sin\theta \cos\theta}{g} = \frac{v_i^2 \sin(2\theta)}{g}\)</span>, which is the standard physics textbook result, or what the AI will tell you if you google “range equation physics”.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>In general, a <span class="math inline">\(n\)</span>th order differential equation has a <span class="math inline">\(n\)</span>th derivative of a function as the highest order derivative of a function. So the equation <span class="math inline">\(f'(x) = f(x) + 3(f(x))^2\)</span> is a 1st order differential equation in <span class="math inline">\(f(x)\)</span> because it has that function, as well as the first derivative of that function only. And <span class="math inline">\(f''(x) = f(x) + 3(f'(x))^2\)</span> is a 2nd order differential equation.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/datawolf04\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>